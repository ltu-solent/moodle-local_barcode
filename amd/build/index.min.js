define(["jquery"],function(a){function b(){a("#id_barcode").focus(),document.getElementById("id_barcode").addEventListener("keypress",f,!1),i()}function c(b){b.stopPropagation(),b.preventDefault();var c=d();return c&&g(c),a("#id_barcode").focus(),!1}function d(){return document.getElementById("id_barcode").value.trim()}function e(){a("#id_barcode").value=""}function f(a){var b=a.which||a.keyCode;return 13===b&&(a.stopPropagation(),a.preventDefault(),c(a)),!1}function g(b){a.ajax({type:"POST",url:"service/upload.php?barcode="+b+"&id="+n,data:{barcode:b},success:function(a){r=a.data.message,o=a.data.code,p=a.data.assignment,h()},error:function(a){r=a.data.message,o=a.data.code,p=a.data.assignment,h()},dataType:"json"})}function h(){var b=a("#feedback");b.html(r),200===o&&(m(),q="Submitted",a("#feedback-group").removeClass("bc-has-danger"),a("#feedback-group").addClass("bc-has-success"),j("success"),e()),200!==o&&(q="Not Submitted",p="-",a("#feedback-group").removeClass("bc-has-success"),a("#feedback-group").addClass("bc-has-danger"),j("fail")),l()}function i(){var b=a("#region-main"),b=a("#region-main"),c=a("<table></table>");c.attr("id","barcode-table"),c.addClass("generaltable"),c.addClass("barcode-table");var d=c.append("<thead></thead>"),e=d.append("<tr></tr>");e.html('<th colspan="8">Barcodes - (<span id="id_count">0</span> Scanned)</th><th colspan="17">Assignment</th><th colspan="5">Submitted (<span id="submit_count">0</span>)</th>'),c.append('<tbody id="tbody"></tbody>'),b.append(c)}function j(b){var c="bc-fail";"success"===b&&(c="bc-success");for(var d=[8,17,5],e=k(),f=a("#tbody"),g=a("<tr></tr>"),h=0;h<=2;h++){var i=a("<td></td>"),j=a("<span></span>"),l=document.createTextNode(e[h]);i.attr("colspan",d[h]),j.append(l),i.append(j),2===h&&(j.addClass("visuallyhidden"),i.addClass(c)),g.append(i)}f.append(g)}function k(){return[d(),p,q]}function l(){return a("#id_count").html(s()),!1}function m(){return a("#submit_count").html(t()),!1}var n,o,p="-",q="Not Submitted",r="",s=function(){function a(){b+=1}var b=0;return function(){return a(),b}}(),t=function(){function a(){b+=1}var b=0;return function(){return a(),b}}();return{init:function(a){b(),n=a}}});