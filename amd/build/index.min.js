define(["jquery"],function(a){function b(){a("#id_barcode").focus(),document.getElementById("id_barcode").addEventListener("keypress",f,!1),i()}function c(b){b.stopPropagation(),b.preventDefault();var c=d();return c&&g(c),a("#id_barcode").focus(),!1}function d(){return document.getElementById("id_barcode").value.trim()}function e(){a("#id_barcode").value=""}function f(a){var b=a.which||a.keyCode;return 13===b&&(a.stopPropagation(),a.preventDefault(),c(a)),!1}function g(b){a.ajax({type:"POST",url:"service/upload.php?barcode="+b+"&id="+n,data:{barcode:b},success:function(a){o=a.data.code,w=a.data.message,x=a.data.assignment,y=a.data.assignmentdescription,p=a.data.course,q=a.data.duedate,r=a.data.idformat,s=a.data.studentid,t=a.data.studentname,u=a.data.submissiontime,v=a.data.islate,h()},error:function(a){o=a.data.code,w=a.data.message,x=a.data.assignment,y=a.data.assignmentdescription,p=a.data.course,q=a.data.duedate,r=a.data.idformat,s=a.data.studentid,t=a.data.studentname,u=a.data.submissiontime,v=a.data.islate,h()},dataType:"json"})}function h(){var b=a("#feedback");b.html(w),200===o&&(m(),z="Submitted",a("#feedback-group").removeClass("bc-has-danger"),a("#feedback-group").addClass("bc-has-success"),j("success"),e()),404===o&&(x="-"),200!==o&&(z="Not Submitted",a("#feedback-group").removeClass("bc-has-success"),a("#feedback-group").addClass("bc-has-danger"),j("fail")),l()}function i(){var b=a("#region-main"),c=a("<table></table>");c.attr("id","barcode-table"),c.addClass("generaltable"),c.addClass("barcode-table");var d=c.append("<thead></thead>"),e=d.append("<tr></tr>");e.html('<th colspan="8">Barcodes - (<span id="id_count">0</span> Scanned)</th><th colspan="17">Assignment Details</th><th colspan="5">Submitted (<span id="submit_count">0</span>)</th>'),c.append('<tbody id="tbody"></tbody>'),b.append(c)}function j(b){var c="bc-fail";"success"===b&&(c="bc-success");for(var d=[8,17,5],e=k(),f=a("#tbody"),g=a("<tr></tr>"),h=0;h<=2;h++){var i=a("<td></td>"),j=a("<span></span>");i.attr("colspan",d[h]),j.html(e[h]),i.append(j),2===h&&(j.addClass("visuallyhidden"),i.addClass(c)),g.append(i)}f.prepend(g)}function k(){var a="bc-ontime";return v&&(a="bc-islate"),[d(),x+"<br /><small>"+y.substring(0,30)+"</small><br /><small>"+p+"</small><br /><small>Student: "+t+" / "+r+": "+s+"</small><br /><small>Due: "+q+'&nbsp; Scanned: <span class="'+a+'">'+u+"</span></small><br />",z]}function l(){return a("#id_count").html(A()),!1}function m(){return a("#submit_count").html(B()),!1}var n,o,p,q,r,s,t,u,v,w="",x="-",y="",z="Not Submitted",A=function(){function a(){b+=1}var b=0;return function(){return a(),b}}(),B=function(){function a(){b+=1}var b=0;return function(){return a(),b}}();return{init:function(a){b(),n=a}}});