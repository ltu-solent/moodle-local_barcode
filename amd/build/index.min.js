define ("local_barcode/index",["jquery","core/str"],function(a,b){var x,y,z,A="",B="-",C="",D,E,F,G,H,I,J="Not Submitted",K,L="0",M="0",N=0,O=[];function c(){a("#id_barcode").focus();document.getElementById("id_barcode").addEventListener("keypress",g,!1);document.getElementById("id_submitbutton").addEventListener("click",h,!1);var c=document.getElementById("id_cancel");c.value="Finish";var d=b.get_strings([{key:"assignmentdetails",component:"local_barcode"},{key:"barcodes",component:"local_barcode"},{key:"draft",component:"local_barcode"},{key:"draftandsubmissionerror",component:"local_barcode"},{key:"due",component:"local_barcode"},{key:"notsubmitted",component:"local_barcode"},{key:"scanned",component:"local_barcode"},{key:"student",component:"local_barcode"},{key:"submitted",component:"local_barcode"}]);a.when(d).done(function(a){O=a;l()})}function d(b){b.stopPropagation();b.preventDefault();var c=e();if(c&&!i()){a("#feedback").html(O[3]);a("#feedback-group").addClass("local-barcode-has-inform");a("#feedback-group").removeClass("local-barcode-has-danger");a("#feedback-group").removeClass("local-barcode-has-success")}if(c&&i()){j(c)}a("#id_barcode").focus();return!1}function e(){return document.getElementById("id_barcode").value.trim()}function f(){a("#id_barcode").val("")}function g(a){var b=a.which||a.keyCode;if(13===b){a.stopPropagation();a.preventDefault();q();s();d(a)}return!1}function h(a){a.stopPropagation();a.preventDefault();q();s();d(a);return!1}function i(){if("0"!==L&&"0"!==M){return!1}return!0}function j(b){var c="service/upload.php?barcode=";if(y){c="../service/upload.php?barcode="}a.ajax({type:"POST",url:c+b+"&id="+x+"&revert="+L+"&ontime="+M,data:{barcode:b},success:function success(a){if("undefined"!=typeof a.faultCode){z=a.faultString;A=a.faultString}else{z=a.code;A=a.message;B=a.assignment;C=a.assignmentdescription;D=a.course;E=a.duedate;F=a.idformat;G=a.studentid;H=a.studentname;I=a.submissiontime;K=a.islate;N=a.reverted;if(!u()){r();t()}}k()},error:function error(){A="Error"},dataType:"json"})}function k(){var b=a("#feedback");b.html(A);var c=0;if(200===z){if("1"===N){J=O[2];a("#feedback-group").addClass("local-barcode-has-success");a("#feedback-group").removeClass("local-barcode-has-danger");a("#feedback-group").removeClass("local-barcode-has-inform");m("revert")}else{J=O[8];a("#feedback-group").removeClass("local-barcode-has-danger");a("#feedback-group").removeClass("local-barcode-has-inform");a("#feedback-group").addClass("local-barcode-has-success");m("success")}}if(404===z){B="-"}if(200!==z){J=O[6];a("#feedback-group").removeClass("local-barcode-has-success");a("#feedback-group").removeClass("local-barcode-has-inform");a("#feedback-group").addClass("local-barcode-has-danger");m("fail");c=1}f();v(c)}function l(){var b=a("#region-main"),c=a("<table></table>");c.attr("id","local-barcode-table");c.addClass("generaltable");c.addClass("local-barcode-table");var d=c.append("<thead></thead>"),e=d.append("<tr></tr>");e.html("<th colspan=\"8\" class=\"local-barcode-th-left local-barcode-sm-hide\">"+O[1]+" - (<span id=\"id_count\">0</span> "+O[6]+")</th><th colspan=\"17\" class=\"local-barcode-th-center\">"+O[0]+"</th><th colspan=\"5\" class=\"local-barcode-th-right\">"+O[8]+"(<span id=\"id_submit_count\">0</span>)</th>");c.append("<tbody id=\"tbody\"></tbody>");b.append(c)}function m(b){for(var c="bc-"+b,d=[8,17,5],e=n(),f=a("#tbody"),g=a("<tr></tr>"),h=0;2>=h;h++){var j=a("<td></td>"),k=a("<span></span>");j.attr("colspan",d[h]);k.html(e[h]);j.append(k);if(0==h){j.addClass("local-barcode-sm-hide")}if(2==h){c+=" local-barcode-td-position";k.addClass("local-barcode-visuallyhidden");j.addClass(c)}g.append(j)}f.prepend(g)}function n(){var a="local-barcode-ontime";if(K){a="local-barcode-islate"}return[e(),B+"<br /><small>"+C.substring(0,30)+"</small><br /><small>"+D+"</small><br /><small>"+O[7]+": "+H+" / "+F+": "+G+"</small><br /><small>"+O[4]+": "+E+"&nbsp; "+O[6]+": <span class=\""+a+"\">"+I+"</span></small><br />",J]}function o(b){a("#id_count").html(b);a("#id_scanned_count").html(b);return!1}function p(b){a("#id_submit_count").html(b);a("#id_submitted_count").html(b);return!1}function q(){if(!0===document.getElementById("id_reverttodraft").checked){L="1"}else{L="0"}}function r(){document.getElementById("id_reverttodraft").checked=!1}function s(){if(document.getElementById("id_submitontime")&&!0===document.getElementById("id_submitontime").checked){M="1"}else{M="0"}}function t(){document.getElementById("id_submitontime").checked=!1}function u(){return document.getElementById("id_multiplescans").checked}function v(b){var c,d=P();if(1===b&&!a("#id_submitted_count").hasClass("local-barcode-error")){w()}if(0===b){c=Q();p(c)}if(!a("#id_scanned_count").hasClass("local-barcode-success")){a("#id_scanned_count").addClass("local-barcode-success")}o(d)}function w(){a("#id_submitted_count").addClass("local-barcode-error")}var P=function(){var b=0;function a(){b+=1}return function(){a();return b}}(),Q=function(){var b=0;function a(){b+=1}return function(){a();return b}}();return{init:function init(a,b){c();x=a;y=b}}});
//# sourceMappingURL=index.min.js.map
